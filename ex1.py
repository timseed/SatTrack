from datetime import datetime, timedelta
from io import StringIO
from pprint import pprint

from pyorbital.orbital import Orbital

amateur_file = """
OSCAR 7 (AO-7)          
1 07530U 74089B   19134.19581420 -.00000034  00000-0  67853-4 0  9992
2 07530 101.7410 102.2252 0012571  56.5062  14.6811 12.53638015 36076
UOSAT 2 (UO-11)         
1 14781U 84021B   19134.14433108  .00000071  00000-0  14786-4 0  9996
2 14781  97.6137 160.5385 0010038  79.0922 281.1422 14.83083120893498
LUSAT (LO-19)           
1 20442U 90005G   19134.68568989  .00000007  00000-0  18820-4 0  9993
2 20442  98.6463  76.7490 0010623 251.2811 108.7220 14.32924582531363
ITAMSAT (IO-26)         
1 22826U 93061D   19133.89688360  .00000014  00000-0  23076-4 0  9991
2 22826  98.8958 121.7165 0010062  91.9677 268.2657 14.30391459336782
RADIO ROSTO (RS-15)     
1 23439U 94085A   19133.86253453 -.00000033  00000-0  26501-3 0  9994
2 23439  64.8140 174.0667 0146720 120.2093 241.3451 11.27567833  3853
JAS-2 (FO-29)           
1 24278U 96046B   19134.05663668  .00000012  00000-0  50666-4 0  9996
2 24278  98.5322 292.3091 0349869 332.5948  25.7111 13.53090808122989
TECHSAT 1B (GO-32)      
1 25397U 98043D   19134.61958919 -.00000011  00000-0  14271-4 0  9998
2 25397  98.6867  75.1933 0002179 114.6525 245.4881 14.23665088 82884
ISS (ZARYA)             
1 25544U 98067A   19135.03449477  .00001814  00000-0  36350-4 0  9992
2 25544  51.6418 165.9249 0001347 355.3690 204.4514 15.52672349170102
PCSAT (NO-44)           
1 26931U 01043C   19134.26384830 -.00000026  00000-0  21776-4 0  9997
2 26931  67.0508  95.0998 0006316 280.1099  79.9290 14.30541374919900
SAUDISAT 1C (SO-50)     
1 27607U 02058C   19134.23593217  .00000013  00000-0  22702-4 0  9998
2 27607  64.5532 157.9978 0082254 263.2837  95.8900 14.75544224881801
CUTE-1 (CO-55)          
1 27844U 03031E   19133.91294634  .00000060  00000-0  46567-4 0  9995
2 27844  98.6849 142.6602 0010805 130.4331 229.7790 14.22175406823169
CUBESAT XI-IV (CO-57)   
1 27848U 03031J   19133.82452292  .00000044  00000-0  39752-4 0  9995
2 27848  98.6927 143.0652 0010506 140.9176 219.2762 14.21770656823015
MOZHAYETS 4 (RS-22)     
1 27939U 03042A   19134.71149207  .00000235  00000-0  50702-4 0  9996
2 27939  98.0344 271.2204 0013098 172.5545 187.5860 14.66777733835415
CUBESAT XI-V            
1 28895U 05043F   19134.37001564  .00000141  00000-0  35912-4 0  9998
2 28895  97.9538 278.3228 0018239 102.6928 257.6315 14.63658543722328
CUTE-1.7+APD II (CO-65) 
1 32785U 08021C   19133.85073857  .00000256  00000-0  33235-4 0  9999
2 32785  97.5495 135.2565 0013804  28.3853 331.8114 14.88294021598358
DELFI-C3 (DO-64)        
1 32789U 08021G   19133.69417400  .00001683  00000-0  11680-3 0  9995
2 32789  97.4673 184.4412 0010780 244.5800 115.4312 15.06867917601442
SEEDS II (CO-66)        
1 32791U 08021J   19134.06365046  .00000277  00000-0  33521-4 0  9995
2 32791  97.5286 141.3946 0013376   4.0915 356.0411 14.90797230598800
YUBILEINY (RS-30)       
1 32953U 08025A   19134.87547881  .00000020  00000-0  75656-4 0  9998
2 32953  82.5016 166.4149 0018669 201.6528 158.3767 12.43089448497988
KKS-1 (KISEKI)          
1 33499U 09002H   19133.93511861  .00000108  00000-0  24034-4 0  9996
2 33499  98.3527 331.4982 0008441 327.7455  32.3236 14.75432028553529
SWISSCUBE               
1 35932U 09051B   19133.93727462  .00000150  00000-0  44881-4 0  9999
2 35932  98.5845 298.8709 0006365 275.7791  84.2680 14.56273491511539
BEESAT-1                
1 35933U 09051C   19134.42338588  .00000141  00000-0  42798-4 0  9997
2 35933  98.5875 301.1124 0004625 290.9364  69.1338 14.56364344511758
ITUPSAT1                
1 35935U 09051E   19134.46074021  .00000111  00000-0  36714-4 0  9990
2 35935  98.5985 301.3912 0006929 285.9333  74.1100 14.55525794511512
XIWANG-1 (HOPE-1)       
1 36122U 09072B   19134.69759781 -.00000052  00000-0 -26954-4 0  9991
2 36122 100.0727 138.7236 0008196  69.1769 291.0217 13.16349231452270
JUGNU                   
1 37839U 11058B   19133.51387279  .00000318  00000-0  27421-4 0  9996
2 37839  19.9599 194.1643 0018760 288.7393 209.2682 14.12649934392134
SRMSAT                  
1 37841U 11058D   19133.49902152  .00000309  00000-0  24635-4 0  9993
2 37841  19.9718 250.2820 0011722 158.4440 278.2899 14.10631350391572
M-CUBED & EXP-1 PRIME   
1 37855U 11061F   19133.70841184  .00000723  00000-0  44298-4 0  9990
2 37855 101.7196  10.8324 0173785 183.4324 176.5709 15.05330572411360
STRAND-1                
1 39090U 13009E   19134.15800983  .00000037  00000-0  28160-4 0  9997
2 39090  98.4921 340.7069 0009970  40.4720 319.7205 14.35082603325297
SOMP                    
1 39134U 13015E   19133.50485885  .00001407  00000-0  73788-4 0  9999
2 39134  64.8616 137.6685 0027764 309.1097  50.7562 15.20063037335096
BEESAT-3                
1 39135U 13015F   19133.82427967  .00001077  00000-0  63388-4 0  9990
2 39135  64.8652 154.4328 0015800 324.1208  35.8856 15.17382910334805
BEESAT-2                
1 39136U 13015G   19134.17755644  .00000849  00000-0  52858-4 0  9992
2 39136  64.8679 157.0064 0016726 310.1746  49.7915 15.16826167334784
ZACUBE-1 (TSHEPISOSAT)  
1 39417U 13066B   19133.89898234  .00000240  00000-0  36385-4 0  9993
2 39417  97.5643 149.4096 0059799 150.0481 210.4176 14.81097769295741
GOMX-1                  
1 39430U 13066Q   19134.44651673 -.00000043  00000-0  13805-5 0  9999
2 39430  97.7438  93.3247 0151400   6.0370 354.2620 14.59235865291466
CUBEBUG-2 (LO-74)       
1 39440U 13066AA  19133.95298332  .00000216  00000-0  37027-4 0  9996
2 39440  97.6020 134.5019 0079711 200.0412 159.7664 14.75837136293505
FUNCUBE-1 (AO-73)       
1 39444U 13066AE  19134.05432263  .00000292  00000-0  42147-4 0  9998
2 39444  97.5625 151.4663 0059102 143.6376 216.8876 14.81912811294653
UWE-3                   
1 39446U 13066AG  19133.95072282  .00000224  00000-0  36260-4 0  9993
2 39446  97.5820 141.4784 0070185 175.4035 184.7837 14.78371233293397
SPROUT                  
1 39770U 14029E   19134.51324052  .00000650  00000-0  78183-4 0  9994
2 39770  97.8811 238.0437 0008546 192.5541 167.5521 14.87296110269608
UNISAT-6                
1 40012U 14033C   19134.17161051  .00000177  00000-0  33835-4 0  9999
2 40012  97.7627   2.3041 0057473 211.2904 148.4880 14.73962535263450
DUCHIFAT-1              
1 40021U 14033M   19134.43626045  .00000339  00000-0  40497-4 0  9999
2 40021  97.9238  58.9147 0013223 159.8869 200.2873 14.90600046266295
QB50P1                  
1 40025U 14033R   19133.81355195  .00000246  00000-0  32169-4 0  9993
2 40025  97.9065  53.5546 0012521 170.8166 189.3282 14.88921016265980
NUDT-PHONESAT           
1 40900U 15049B   19134.82063833  .00002869  00000-0  12616-3 0  9997
2 40900  97.4382 144.5014 0011318 312.3038 171.9914 15.22650983202356
ZDPS 2A                 
1 40901U 15049C   19134.87004810  .00000840  00000-0  44991-4 0  9992
2 40901  97.4596 141.2005 0012492 331.5617 147.7058 15.17665809201950
ZDPS 2B                 
1 40902U 15049D   19134.82568465  .00002259  00000-0  11604-3 0  9999
2 40902  97.4552 138.7077 0012470 328.0316 155.4316 15.17463481201928
XW-2A                   
1 40903U 15049E   19134.73906766  .00002092  00000-0  51511-4 0  9997
2 40903  97.3414 177.3021 0011780 272.4602 221.8159 15.41716556204866
KAITUO 1A               
1 40904U 15049F   19134.78192130  .00000566  00000-0  33494-4 0  9999
2 40904  97.4672 137.3905 0013610 335.7604   9.8262 15.15331991201706
2015-049G               
1 40905U 15049G   19134.77450231  .00000235  00000-0  16431-4 0  9993
2 40905  97.4703 134.9811 0014653 329.6037  32.2377 15.14261769201599
XW-2C                   
1 40906U 15049H   19134.74249417  .00001205  00000-0  66779-4 0  9991
2 40906  97.4677 137.4044 0013611 326.3256 120.5798 15.15631316201707
XW-2D                   
1 40907U 15049J   19134.72429560  .00000564  00000-0  32983-4 0  9996
2 40907  97.4652 137.0633 0013004 324.1857 122.1955 15.15812885201716
LILACSAT-2              
1 40908U 15049K   19134.76294277  .00001393  00000-0  80699-4 0  9994
2 40908  97.4781 136.0082 0015171 329.8711 146.6100 15.13776137201524
XW-2F                   
1 40910U 15049M   19134.79187589  .00000748  00000-0  40967-4 0  9994
2 40910  97.4617 139.0436 0013594 316.9950 167.4104 15.17220524201725
XW-2B                   
1 40911U 15049N   19134.68988593  .00001377  00000-0  75575-4 0  9999
2 40911  97.4680 137.6661 0013108 325.0012 124.3022 15.15746123201605
KAITUO 1B               
1 40912U 15049P   19134.78655093  .00001135  00000-0  56571-4 0  9994
2 40912  97.4507 142.5953 0013259 297.1385  59.4486 15.19523482202004
TIANWANG 1C (TW-1C)     
1 40926U 15051B   19134.78122197  .00015723  00000-0  23522-3 0  9993
2 40926  97.1396 181.0106 0009786 133.5087 318.9844 15.55019343204731
TIANWANG 1A (TW-1A)     
1 40928U 15051D   19134.74579431  .00004233  00000-0  10599-3 0  9992
2 40928  97.1489 166.8233 0010515 192.4092 259.2415 15.40567974203798
LAPAN-A2                
1 40931U 15052B   19134.83444469  .00001428  00000-0  10967-3 0  9991
2 40931   5.9799 305.1479 0015267  43.6192 316.6223 14.76616356196108
E-ST@R-II               
1 41459U 16025D   19134.77621800  .00003476  00000-0  17963-3 0  9995
2 41459  98.1011 219.5336 0169534 115.7686 246.1099 15.05362939167295
AAUSAT 4                
1 41460U 16025E   19134.19754415  .00003989  00000-0  20198-3 0  9995
2 41460  98.0950 220.0765 0159270 110.5489 251.3047 15.07193011167321
NUSAT-1 (FRESCO)        
1 41557U 16033B   19134.72738804  .00002997  00000-0  11510-3 0  9990
2 41557  97.4171 222.4334 0015399  65.2222 295.0617 15.27131114164758
BEESAT-4                
1 41619U 16040W   19134.16912354  .00001674  00000-0  74003-4 0  9997
2 41619  97.3701 197.0506 0012486 142.0836 218.1282 15.23025249148452
CAS-2T & KS-1Q          
1 41847U 16066G   19134.12243585  .00000039  00000-0  16987-4 0  9998
2 41847  98.7094 174.2711 0365544 340.9516  17.8291 14.37979666131888
NAYIF-1 (EO-88)         
1 42017U 17008BX  19134.40709690  .00002024  00000-0  82967-4 0  9997
2 42017  97.4053 201.8616 0004654 301.6604  58.4180 15.25423638124548
MAX VALIER SAT          
1 42778U 17036P   19134.22302052  .00001329  00000-0  61244-4 0  9995
2 42778  97.3573 192.6652 0012089 357.6295   2.4882 15.21947031104846
RADFXSAT (FOX-1B)       
1 43017U 17073E   19133.72931430  .00000457  00000-0  41938-4 0  9994
2 43017  97.7235  56.4933 0256824 275.5946  81.6030 14.78518596 79946
FOX-1D (AO-92)          
1 43137U 18004AC  19133.83178324  .00001209  00000-0  53822-4 0  9990
2 43137  97.4897 201.7104 0010065  31.7872 328.3970 15.23387092 74046
ES'HAIL 2               
1 43700U 18090A   19134.18143153  .00000130  00000-0  00000+0 0  9999
2 43700   0.0134 272.1766 0002112 173.2684 237.2805  1.00270228  1934
FOX-1CLIFF (AO-95)      
1 43770U 18099N   19133.88872635  .00000622  00000-0  62445-4 0  9997
2 43770  97.7469 206.2115 0016289  93.5689 266.7395 14.94741029 24070
ITASAT 1                
1 43786U 18099AE  19134.18211672 -.00000110  00000-0 -47681-5 0  9996
2 43786  97.7480 206.6269 0016761  87.4154 272.8985 14.95115103 24126
JY1SAT (JO-97)          
1 43803U 18099AX  19134.16991763  .00000149  00000-0  18753-4 0  9997
2 43803  97.7441 206.5509 0016839  88.1084 272.2065 14.95242491 24118"""
tle = StringIO()
tle.write(amateur_file)
orb = Orbital("AO-7", line1="1 07530U 74089B   19134.19581420 -.00000034  00000-0  67853-4 0  9992",
              line2="2 07530 101.7410 102.2252 0012571  56.5062  14.6811 12.53638015 36076")
now = datetime.utcnow()
# arrayat=Orbital.get_observer_look(lon=120.77,lat=15.15,alt=0.020)
pprint(orb)
# >>> # Get longitude, latitude and altitude of the satellite: >>>
pprint(orb.get_lonlatalt(now))
passes = orb.get_next_passes(now, length=4, lon=120.77, lat=15.15, alt=0.02)
#
# Each Pass a tuple of 3, rise, set, max ele
#
start_pass = passes[0][0]
end_pass = passes[0][1]
min_elevation = 10
while (start_pass<end_pass):
    sky_location  = orb.get_observer_look(start_pass,lon=120.77, lat=15.15, alt=0.02)
    if sky_location[1]>= min_elevation:
        print("Az  {:6.2f}  Ele {:6.2f} ".format(sky_location[0],sky_location[1]))
        
    start_pass = start_pass + timedelta(seconds=60)
print("Pass ended")